function fluidDialog(){var a=$(".ui-dialog:visible");a.each(function(){var a=$(this),b=a.find(".ui-dialog-content").data("ui-dialog");if(b.options.fluid){var c=$(window).width();c<parseInt(b.options.maxWidth)+50?a.css("max-width","90%"):a.css("max-width",b.options.maxWidth+"px"),b.option("position",b.options.position)}})}var gca=gca||{};gca.namespace=function(a){var b=a.split("."),c=b.length,d=gca,e=0;for("gca"===b[0]&&(e+=1);c>e;e+=1)"undefined"==typeof d[b[e]]&&(d[b[e]]={}),d=d[b[e]];return d},$.ajaxSetup({cache:!1}),displayConfirm=function(a,b){$("#messageDialog span").html(a),$("#messageDialog").dialog({modal:!0,title:"Confirm Action",buttons:{OK:function(){$("#messageDialog").dialog("close"),b&&b()},Cancel:function(){$("#messageDialog").dialog("close")}},close:function(){$("#messageDialog span").empty()}})},$(window).resize(function(){fluidDialog()}),$(document).on("dialogopen",".ui-dialog",function(a,b){fluidDialog()}),window.onload=function(){if(-1!==navigator.userAgent.indexOf("Safari")&&-1===navigator.userAgent.indexOf("Chrome")){var a=document.cookie;if(top.location!==document.location){var b=document.referrer.indexOf("return=");a||-1!==b||(href=document.location.href,href=-1===href.indexOf("?")?href+"?":href+"&",top.location.href=href+"reref="+encodeURIComponent(document.referrer))}else ts=(new Date).getTime(),document.cookie="ts="+ts,rerefidx=document.location.href.indexOf("reref="),-1!==rerefidx&&(href=decodeURIComponent(document.location.href.substr(rerefidx+6)),href=-1===href.indexOf("?")?href+"?":href+"&",href+="return=1",window.location.replace(href))}},Date.prototype.stdTimezoneOffset=function(){var a=new Date(this.getFullYear(),0,1),b=new Date(this.getFullYear(),6,1);return Math.max(a.getTimezoneOffset(),b.getTimezoneOffset())},Date.prototype.dst=function(){return this.getTimezoneOffset()<this.stdTimezoneOffset()},gca.namespace("image"),gca.image=function(a,b,c){downloadUrl="/image/download";var d=function(){e(),f()},e=function(){c("#btnGray").off("click").on("click",function(a){a.preventDefault(),onGrayscaleClick()}),c("#btnPoster").off("click").on("click",function(a){a.preventDefault(),onPosterizeClick()}),c("#btnFinish").off("click").on("click",function(a){a.preventDefault(),onFinishClick()}),c("#btnResize").off("click").on("click",function(a){a.preventDefault(),g()}),c("#btnDownload").off("click").on("click",function(a){a.preventDefault(),onDownloadClick()}),c("#btnBrtInc").off("click").on("click",function(a){a.preventDefault(),onBrtIncrease()}),c("#btnBrtDec").off("click").on("click",function(a){a.preventDefault(),onBrtDecrease()}),c("#btnConInc").off("click").on("click",function(a){a.preventDefault(),onConIncrease()}),c("#btnConDec").off("click").on("click",function(a){a.preventDefault(),onConDecrease()}),c("#btnShpInc").off("click").on("click",function(a){a.preventDefault(),onShpIncrease()}),c("#btnShpDec").off("click").on("click",function(a){a.preventDefault(),onShpDecrease()}),c("#btnBlrInc").off("click").on("click",function(a){a.preventDefault(),onBlrIncrease()}),c("#btnBlrDec").off("click").on("click",function(a){a.preventDefault(),onBlrDecrease()})},f=function(){var a="/image/uploadimage/upload";c("#fileupload").fileupload({url:a,dataType:"json",done:function(a,b){c(".number-val").val(0),console.log("done with upload"),c("#loading").hide(),c.each(b.result,function(a,b){200==b.status&&(c(".image-original img").attr("src",b.original_file),c("#image").val(b.final_file),c(".image-preview img").attr("src",b.final_file),c(".image-preview p.help-block").html("New Image"))}),console.log("new image")}})},g=function(){c("#loading").show(),c.ajax({url:"/image/resizeImage",method:"post",dataType:"json",data:{imgPath:c("#image").val()},success:function(a,b,d){console.log("resizing complete"),console.log(a),c("#loading").hide(),c("#image").val(a.final_file),c(".image-preview img").attr("src",a.final_file),c(".image-preview p.help-block").html("Resized Image")},error:function(a,b,c){console.log("nope")}})};return onGrayscaleClick=function(){c("#loading").show(),c.ajax({url:"/image/grayscaleImage",method:"post",dataType:"json",data:{imgPath:c("#image").val()},success:function(a,b,d){console.log("grayscale complete"),console.log(a),c("#loading").hide(),c("#image").val(a.final_file),c(".image-preview img").attr("src",a.final_file),c(".image-preview p.help-block").html("Grayscale Image")},error:function(a,b,c){console.log("nope")}})},onPosterizeClick=function(){c("#loading").show(),c.ajax({url:"/image/posterizeImage",method:"post",dataType:"json",data:{imgPath:c("#image").val()},success:function(a,b,d){console.log("posterize complete"),console.log(a),c("#loading").hide(),c("#image").val(a.final_file),c(".image-preview img").attr("src",a.final_file),c(".image-preview p.help-block").html("Posterized Image")},error:function(a,b,c){console.log("nope")}})},onFinishClick=function(){c("#loading").show(),c.ajax({url:"/image/finishImage",method:"post",dataType:"json",data:{imgPath:c("#image").val()},success:function(a,b,d){console.log("finish complete"),console.log(a),c("#loading").hide(),c("#image").val(a.final_file),c(".image-preview img").attr("src",a.final_file),c(".image-preview p.help-block").html("Numbered Image")},error:function(a,b,c){console.log("nope")}})},onDownloadClick=function(){c("#imageEdit").attr("action",downloadUrl),c("#image").val(),c("#imageEdit").submit()},onBrtIncrease=function(){c("#loading").show(),c.ajax({url:"/image/adjustImage/brtinc",method:"post",dataType:"json",data:{imgPath:c("#image").val()},success:function(a,d,e){console.log("brightness +");var f=c("#btnBrtInc").closest("div").find(".number-val"),g=parseInt(f.val());c.isNumeric(g)&&f.val(g+1),c("#loading").hide(),b=new Date,c("#image").val(a.original_file),c(".image-preview img").attr("src",a.final_file+"?x="+b.getTime())},error:function(a,b,c){console.log("nope")}})},onBrtDecrease=function(){c("#loading").show(),c.ajax({url:"/image/adjustImage/brtdec",method:"post",dataType:"json",data:{imgPath:c("#image").val()},success:function(a,d,e){console.log("brightness -");var f=c("#btnBrtDec").closest("div").find(".number-val"),g=parseInt(f.val());c.isNumeric(g)&&f.val(g-1),c("#loading").hide(),b=new Date,c("#image").val(a.original_file),c(".image-preview img").attr("src",a.final_file+"?x="+b.getTime())},error:function(a,b,c){console.log("nope")}})},onConIncrease=function(){c("#loading").show(),c.ajax({url:"/image/adjustImage/coninc",method:"post",dataType:"json",data:{imgPath:c("#image").val()},success:function(a,d,e){console.log("contrast +");var f=c("#btnConInc").closest("div").find(".number-val"),g=parseInt(f.val());c.isNumeric(g)&&f.val(g+1),c("#loading").hide(),b=new Date,c("#image").val(a.original_file),c(".image-preview img").attr("src",a.final_file+"?x="+b.getTime())},error:function(a,b,c){console.log("nope")}})},onConDecrease=function(){c("#loading").show(),c.ajax({url:"/image/adjustImage/condec",method:"post",dataType:"json",data:{imgPath:c("#image").val()},success:function(a,d,e){console.log("contrast -");var f=c("#btnConDec").closest("div").find(".number-val"),g=parseInt(f.val());c.isNumeric(g)&&f.val(g-1),c("#loading").hide(),b=new Date,c("#image").val(a.original_file),c(".image-preview img").attr("src",a.final_file+"?x="+b.getTime())},error:function(a,b,c){console.log("nope")}})},onShpIncrease=function(){c("#loading").show(),c.ajax({url:"/image/adjustImage/shpinc",method:"post",dataType:"json",data:{imgPath:c("#image").val()},success:function(a,d,e){console.log("sharpness +");var f=c("#btnShpInc").closest("div").find(".number-val"),g=parseInt(f.val());c.isNumeric(g)&&f.val(g+1),c("#loading").hide(),b=new Date,c("#image").val(a.original_file),c(".image-preview img").attr("src",a.final_file+"?x="+b.getTime())},error:function(a,b,c){console.log("nope")}})},onShpDecrease=function(){c("#loading").show(),c.ajax({url:"/image/adjustImage/shpdec",method:"post",dataType:"json",data:{imgPath:c("#image").val()},success:function(a,d,e){console.log("sharpness -");var f=c("#btnShpDec").closest("div").find(".number-val"),g=parseInt(f.val());c.isNumeric(g)&&f.val(g-1),c("#loading").hide(),b=new Date,c("#image").val(a.original_file),c(".image-preview img").attr("src",a.final_file+"?x="+b.getTime())},error:function(a,b,c){console.log("nope")}})},onBlrIncrease=function(){c("#loading").show(),c.ajax({url:"/image/adjustImage/blrinc",method:"post",dataType:"json",data:{imgPath:c("#image").val()},success:function(a,d,e){console.log("blur +");var f=c("#btnBlrInc").closest("div").find(".number-val"),g=parseInt(f.val());c.isNumeric(g)&&f.val(g+1),c("#loading").hide(),b=new Date,c("#image").val(a.original_file),c(".image-preview img").attr("src",a.final_file+"?x="+b.getTime())},error:function(a,b,c){console.log("nope")}})},onBlrDecrease=function(){c("#loading").show(),c.ajax({url:"/image/adjustImage/blrdec",method:"post",dataType:"json",data:{imgPath:c("#image").val()},success:function(a,d,e){console.log("blur -");var f=c("#btnBlrInc").closest("div").find(".number-val"),g=parseInt(f.val());c.isNumeric(g)&&f.val(g-1),c("#loading").hide(),b=new Date,c("#image").val(a.original_file),c(".image-preview img").attr("src",a.final_file+"?x="+b.getTime())},error:function(a,b,c){console.log("nope")}})},{initialize:d}}(window,document,jQuery);